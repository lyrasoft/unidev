{"version":3,"sources":["captcha/gregwar.js"],"names":["$","Phoenix","plugin","$element","options","$image","find","$input","$refreshButton","$buttonIcon","bindEvents","on","addClass","src","attr","t","Date","getTime","toString","Math","random","indexOf","one","removeClass","val"],"mappings":";;;;;;AAAA;;;;;;;AAOAA,EAAE,YAAM;AACNC,UAAQC,MAAR,CAAe,SAAf;AACE,4BAAYC,QAAZ,EAAoC;AAAA,UAAdC,OAAc,uEAAJ,EAAI;;AAAA;;AAClC,WAAKD,QAAL,GAAgBA,QAAhB;AACA,WAAKC,OAAL,GAAeA,OAAf;AACA,WAAKC,MAAL,GAAc,KAAKF,QAAL,CAAcG,IAAd,CAAmB,sBAAnB,CAAd;AACA,WAAKC,MAAL,GAAc,KAAKJ,QAAL,CAAcG,IAAd,CAAmB,sBAAnB,CAAd;AACA,WAAKE,cAAL,GAAsB,KAAKL,QAAL,CAAcG,IAAd,CAAmB,wBAAnB,CAAtB;AACA,WAAKG,WAAL,GAAmB,KAAKN,QAAL,CAAcG,IAAd,CAAmB,qBAAnB,CAAnB;;AAEA,WAAKI,UAAL;AACD;;AAVH;AAAA;AAAA,mCAYe;AAAA;;AACX,aAAKF,cAAL,CAAoBG,EAApB,CAAuB,OAAvB,EAAgC,YAAM;AACpC,gBAAKF,WAAL,CAAiBG,QAAjB,CAA0B,SAA1B;;AAEA,cAAIC,MAAM,MAAKR,MAAL,CAAYS,IAAZ,CAAiB,YAAjB,CAAV;AACA,cAAMC,IAAK,IAAIC,IAAJ,EAAD,CAAWC,OAAX,GAAqBC,QAArB,KAAkC,GAAlC,GAAyCC,KAAKC,MAAL,KAAgB,KAAnE;;AAEA,cAAIP,IAAIQ,OAAJ,CAAY,GAAZ,MAAqB,CAAC,CAA1B,EAA6B;AAC3BR,mBAAO,QAAQE,CAAf;AACD,WAFD,MAEO;AACLF,mBAAO,QAAQE,CAAf;AACD;;AAED,gBAAKV,MAAL,CAAYiB,GAAZ,CAAgB,MAAhB,EAAwB,YAAM;AAC5B,kBAAKb,WAAL,CAAiBc,WAAjB,CAA6B,SAA7B;AACA,kBAAKhB,MAAL,CAAYiB,GAAZ,CAAgB,EAAhB;AACD,WAHD;AAIA,gBAAKnB,MAAL,CAAYS,IAAZ,CAAiB,KAAjB,EAAwBD,GAAxB;AACD,SAjBD;AAkBD;AA/BH;;AAAA;AAAA;AAiCD,CAlCD","file":"gregwar.js","sourcesContent":["/**\n * Part of earth project.\n *\n * @copyright  Copyright (C) 2018 ${ORGANIZATION}.\n * @license    __LICENSE__\n */\n\n$(() => {\n  Phoenix.plugin('gregwar', class GregwarCaptcha {\n    constructor($element, options = {}) {\n      this.$element = $element;\n      this.options = options;\n      this.$image = this.$element.find('[data-captcha-image]');\n      this.$input = this.$element.find('[data-captcha-input]');\n      this.$refreshButton = this.$element.find('[data-captcha-refresh]');\n      this.$buttonIcon = this.$element.find('[data-refresh-icon]');\n\n      this.bindEvents();\n    }\n\n    bindEvents() {\n      this.$refreshButton.on('click', () => {\n        this.$buttonIcon.addClass('fa-spin');\n\n        let src = this.$image.attr('data-image');\n        const t = (new Date).getTime().toString() + '.' + (Math.random() * 10000);\n\n        if (src.indexOf('?') !== -1) {\n          src += '&t=' + t;\n        } else {\n          src += '?t=' + t;\n        }\n\n        this.$image.one('load', () => {\n          this.$buttonIcon.removeClass('fa-spin');\n          this.$input.val('');\n        });\n        this.$image.attr('src', src);\n      });\n    }\n  });\n});\n"]}